---
title: LeetCode-88.合并两个有序数组
date: '2025-04-30'
tags: ['java', 'algorithm']
draft: false
summary: LeetCode练级
---

原题链接：https://leetcode.cn/problems/merge-sorted-array/description/

```java

import java.util.Arrays;

public class ProblemMergeSortedArray {

    public static void merge(int[] nums1, int m, int[] nums2, int n) {
        if (nums1 == null || nums2 == null) {
            throw new IllegalArgumentException("Input arrays must not be null!");
        }
        if (m < 0 || n < 0) {
            throw new IllegalArgumentException("Length parameters must be non-negative!");
        }
        if (m + n > nums1.length) {
            throw new IllegalArgumentException("nums1 Length is insufficient to hold merged result!");
        }
        if (m > nums1.length || n > nums2.length) {
            throw new IllegalArgumentException("Length parameter exceed actual array length!");
        }
        int nums1Index = 0;
        int nums2Index = 0;
        int mergedIndex = 0;
        int[] mergedArray = new int[m + n];

        while (nums1Index < m && nums2Index < n) {
            if (nums1[nums1Index] < nums2[nums2Index]) {
                mergedArray[mergedIndex++] = nums1[nums1Index++];
            } else {
                mergedArray[mergedIndex++] = nums2[nums2Index++];
            }
        }
        while (nums1Index < m) {
            mergedArray[mergedIndex++] = nums1[nums1Index++];
        }
        while (nums2Index < n) {
            mergedArray[mergedIndex++] = nums2[nums2Index++];
        }
        System.arraycopy(mergedArray, 0, nums1, 0, m + n);
    }

    public static void testMerge(String testName, int[] nums1, int m, int[] nums2, int n, int[] expected) {
        System.out.println("=== Test Case: " + testName + " ===");
        try {
            int[] originalNums1 = nums1 != null ? Arrays.copyOf(nums1, nums1.length) : null;
            if (expected == null) {
                // 异常抛出测试
                try {
                    merge(nums1, m, nums2, n);
                    // 预期抛出的异常，并没有抛出
                    System.out.println("FAIL - Expected exception but none thrown");
                } catch (Exception e) {
                    System.out.println("PASS - Caught expected exception: " + e.getClass().getSimpleName() + " - " + e.getMessage());
                }

            } else {
                // 正常测试
                merge(nums1, m, nums2, n);
                if (Arrays.equals(nums1, expected)) {
                    System.out.println("PASS");
                } else {
                    System.out.println("FAIL");
                }
                System.out.println("Input nums1: " + Arrays.toString(originalNums1) + ", m: " + m);
                System.out.println("Input nums2: " + Arrays.toString(nums2) + ", n: " + n);
                System.out.println("Expected:    " + Arrays.toString(expected));
                System.out.println("Actual:      " + Arrays.toString(nums1));
            }
        } catch (Exception e) {
            System.out.println("FAIL - Unexpected exception: " + e.getMessage());
        }
    }


    public static void main(String[] args) {
        // 正常情况测试
        testMerge("Both arrays with elements",
                new int[]{1, 3, 5, 0, 0, 0}, 3,
                new int[]{2, 4, 6}, 3,
                new int[]{1, 2, 3, 4, 5, 6});

        testMerge("nums1 empty",
                new int[]{0, 0, 0}, 0,
                new int[]{2, 4, 6}, 3,
                new int[]{2, 4, 6});

        testMerge("nums2 empty",
                new int[]{1}, 1,
                new int[]{}, 0,
                new int[]{1});

        testMerge("All elements same",
                new int[]{2, 2, 2, 0, 0}, 3,
                new int[]{2, 2}, 2,
                new int[]{2, 2, 2, 2, 2});

        testMerge("With duplicates",
                new int[]{1, 2, 3, 0, 0, 0}, 3,
                new int[]{2, 5, 6}, 3,
                new int[]{1, 2, 2, 3, 5, 6});

        // 异常情况测试
        testMerge("nums1 is null", null, 0, new int[]{1, 2}, 2, null);
        testMerge("nums2 is null", new int[]{1, 2, 0}, 2, null, 1, null);
        testMerge("m is negative", new int[]{1, 2, 0}, -1, new int[]{3}, 1, null);
        testMerge("n is negative", new int[]{1, 2, 0}, 2, new int[]{3}, -1, null);
        testMerge("nums1 too short", new int[]{1, 2}, 2, new int[]{3, 4}, 2, null);
        testMerge("m exceeds nums1 length", new int[]{1, 2}, 3, new int[]{3}, 1, null);
        testMerge("n exceeds nums2 length", new int[]{1, 2, 0}, 2, new int[]{3}, 2, null);
    }
}
```
